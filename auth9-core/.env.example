# Auth9 Core Configuration

# HTTP Server
HTTP_HOST=0.0.0.0
HTTP_PORT=8080

# gRPC Server
GRPC_HOST=0.0.0.0
GRPC_PORT=50051

# Database (TiDB/MySQL)
DATABASE_URL=mysql://root:password@localhost:4000/auth9
DATABASE_MAX_CONNECTIONS=10
DATABASE_MIN_CONNECTIONS=2

# Redis
REDIS_URL=redis://localhost:6379

# JWT
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_ISSUER=https://auth9.example.com
JWT_ACCESS_TOKEN_TTL_SECS=3600
JWT_REFRESH_TOKEN_TTL_SECS=604800
# RSA keys for JWT signing (RS256). Use \n for line breaks.
# Generate with: openssl genrsa 2048 | openssl pkcs8 -topk8 -nocrypt
JWT_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----
# Extract public key: openssl rsa -pubout < private.pem
JWT_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----\nYOUR_PUBLIC_KEY_HERE\n-----END PUBLIC KEY-----

# Keycloak
KEYCLOAK_URL=http://localhost:8081
KEYCLOAK_REALM=auth9

# Keycloak Admin Client (Confidential Client)
KEYCLOAK_ADMIN_CLIENT_ID=auth9-admin
KEYCLOAK_ADMIN_CLIENT_SECRET=dev-client-secret-change-in-production
# For production, retrieve secret from Keycloak after running 'auth9-core init'

# Keycloak Admin Credentials (master realm admin user)
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin

# ============================================================
# SECURITY CONFIGURATION
# ============================================================

# Rate Limiting (enabled by default for production security)
# Set to false only for local development
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_REQUESTS=100
RATE_LIMIT_DEFAULT_WINDOW_SECS=60
# Note: Login endpoint (/api/v1/auth/token) is limited to 10 req/min
# Password reset (/api/v1/auth/forgot-password) is limited to 5 req/min

# gRPC Security
# ⚠️ CRITICAL: gRPC exposes sensitive operations (token exchange, role queries)
# auth_mode: "none" (dev only), "api_key" (recommended), or "mtls" (production)
# For development:
GRPC_AUTH_MODE=none
# For production (uncomment and set secure keys):
# GRPC_AUTH_MODE=api_key
# GRPC_API_KEYS=your-secure-api-key-1,your-secure-api-key-2
# Generate secure keys: openssl rand -base64 32
GRPC_ENABLE_REFLECTION=false

# CORS (default: localhost only)
# CORS_ALLOWED_ORIGINS=https://portal.example.com,https://admin.example.com
CORS_ALLOW_CREDENTIALS=true
