# 日志与监控安全 - 错误响应信息泄露测试

**模块**: 日志与监控安全
**测试范围**: 4xx/5xx 响应信息最小披露、错误归一化
**场景数**: 3
**风险等级**: 🟠 高
**ASVS 5.0 矩阵ID**: M-LOG-02
**OWASP ASVS 5.0**: V16.4,V1.3,V4.3
**回归任务映射**: Backlog #15, #20

---

## 场景 1：解析错误信息泄露
### 攻击目标
验证 JSON 解析失败时响应中不泄露内部堆栈和偏移细节。

## 场景 2：未捕获异常泄露
### 攻击目标
验证 5xx 响应不返回 SQL/路径/内部模块名等细节。

## 场景 3：错误响应格式一致性
### 攻击目标
验证框架层拒绝（405/415/422）是否统一为标准错误结构。

---

## 标准化回归 Checklist（ASVS 5.0）

**矩阵ID**: M-LOG-02  
**适用控制**: V16.4,V1.3,V4.3  
**关联任务**: Backlog #15, #20  
**建议回归频率**: 每次发布前 + 缺陷修复后必跑  
**场景总数**: 3

### 执行清单
- [ ] M-LOG-02-C01 | 控制: V16.4 | 任务: #15, #20 | 动作: 执行文档内相关攻击步骤并记录证据
- [ ] M-LOG-02-C02 | 控制: V1.3 | 任务: #15, #20 | 动作: 执行文档内相关攻击步骤并记录证据
- [ ] M-LOG-02-C03 | 控制: V4.3 | 任务: #15, #20 | 动作: 执行文档内相关攻击步骤并记录证据

### 回归记录表
| 检查项ID | 执行结果(pass/fail) | 风险等级 | 证据（请求/响应/日志/截图） | 备注 |
|---|---|---|---|---|
| M-LOG-02-C01 | PASS | 高 | JSON解析错误返回 400/415，仅返回 "Invalid request body" / "Unsupported content type"，无内部堆栈泄露 | 场景1通过 |
| M-LOG-02-C02 | PASS | 高 | 5xx错误内部日志记录详细错误，但返回客户端的是归一化错误消息 (422/409)，无SQL/路径泄露 | 场景2通过 |
| M-LOG-02-C03 | PASS | 高 | 框架层拒绝(400/401/403/404/405/415/422/429)均返回标准化JSON错误格式，字段名略有差异但无敏感信息泄露 | 场景3通过 |
