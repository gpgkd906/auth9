# 文件与资源安全 - Theme 外链资源 URL 安全测试

**模块**: 文件与资源安全
**测试范围**: logo/favicon 等 URL 字段的协议、域名与可达性约束
**场景数**: 3
**风险等级**: 🟠 高
**ASVS 5.0 矩阵ID**: M-FILE-02
**OWASP ASVS 5.0**: V5.2,V3.4,V14.2
**回归任务映射**: Backlog #18, #20

---

## 场景 1：危险协议注入
### 攻击目标
验证 `javascript:`、`data:`、`file:` 等危险协议被拒绝。

## 场景 2：外链域名控制
### 攻击目标
验证资源 URL 是否允许任意第三方域名，是否有白名单策略。

## 场景 3：资源 URL 导致隐私泄露
### 攻击目标
验证登录页加载外链资源是否泄露访问元数据与 referrer。

---

## 标准化回归 Checklist（ASVS 5.0）

**矩阵ID**: M-FILE-02  
**适用控制**: V5.2,V3.4,V14.2  
**关联任务**: Backlog #18, #20  
**建议回归频率**: 每次发布前 + 缺陷修复后必跑  
**场景总数**: 3

### 执行清单
- [ ] M-FILE-02-C01 | 控制: V5.2 | 任务: #18, #20 | 动作: 执行文档内相关攻击步骤并记录证据
- [ ] M-FILE-02-C02 | 控制: V3.4 | 任务: #18, #20 | 动作: 执行文档内相关攻击步骤并记录证据
- [ ] M-FILE-02-C03 | 控制: V14.2 | 任务: #18, #20 | 动作: 执行文档内相关攻击步骤并记录证据

### 回归记录表
| 检查项ID | 执行结果(pass/fail) | 风险等级 | 证据（请求/响应/日志/截图） | 备注 |
|---|---|---|---|---|
|  |  |  |  |  |
