# Auth9 Secrets Template
# Copy this file to secrets.yaml and fill in actual values
# DO NOT commit secrets.yaml to version control!
#
# Create secrets with:
#   kubectl create secret generic auth9-secrets \
#     --from-literal=DATABASE_URL='mysql://user:pass@host:4000/auth9' \
#     --from-literal=REDIS_URL='redis://host:6379' \
#     --from-literal=JWT_SECRET='your-jwt-secret' \
#     --from-literal=JWT_PRIVATE_KEY='your-rsa-private-key-pem' \
#     --from-literal=JWT_PUBLIC_KEY='your-rsa-public-key-pem' \
#     --from-literal=KEYCLOAK_URL='http://keycloak:8080' \
#     --from-literal=KEYCLOAK_ADMIN_CLIENT_SECRET='secret' \
#     --from-literal=SESSION_SECRET='your-session-secret' \
#     --from-literal=KEYCLOAK_WEBHOOK_SECRET='your-webhook-secret' \
#     --from-literal=GRPC_API_KEYS='your-grpc-api-key' \
#     -n auth9

apiVersion: v1
kind: Secret
metadata:
  name: auth9-secrets
  namespace: auth9
  labels:
    app.kubernetes.io/name: auth9
type: Opaque
stringData:
  # Database connection string (TiDB)
  DATABASE_URL: "mysql://root:password@tidb-cluster:4000/auth9"
  
  # Redis connection string
  REDIS_URL: "redis://redis-cluster:6379"
  
  # JWT signing secret (generate with: openssl rand -hex 32)
  JWT_SECRET: "CHANGE_ME_generate_with_openssl_rand_hex_32"

  # JWT RSA key pair for RS256 token signing (required)
  # Generate with: openssl genrsa -out private.pem 2048 && openssl rsa -in private.pem -pubout -out public.pem
  JWT_PRIVATE_KEY: "<YOUR_RSA_PRIVATE_KEY_PEM>"
  JWT_PUBLIC_KEY: "<YOUR_RSA_PUBLIC_KEY_PEM>"
  
  # Keycloak configuration
  KEYCLOAK_URL: "http://keycloak:8080"

  # Keycloak Admin Credentials (master realm admin user)
  KEYCLOAK_ADMIN: "admin"
  KEYCLOAK_ADMIN_PASSWORD: "CHANGE_ME_admin_password"

  # Keycloak Admin Client Secret (auto-generated during init, retrieve from logs)
  # After running auth9-init job, get the secret from logs:
  #   kubectl logs job/auth9-init -n auth9 | grep "KEYCLOAK_ADMIN_CLIENT_SECRET"
  KEYCLOAK_ADMIN_CLIENT_SECRET: "<COPY_FROM_AUTH9_INIT_JOB_LOGS>"
  
  # Session secret for portal (generate with: openssl rand -hex 32)
  SESSION_SECRET: "CHANGE_ME_generate_with_openssl_rand_hex_32"

  # Keycloak Webhook Secret for verifying login events (generate with: openssl rand -hex 32)
  # Must match KC_SPI_EVENTS_LISTENER_EXT_EVENT_HTTP_HMAC_SECRET in keycloak-secrets
  KEYCLOAK_WEBHOOK_SECRET: "CHANGE_ME_generate_with_openssl_rand_hex_32"

  # Settings encryption key (AES-256, generate with: openssl rand -base64 32)
  # Used to encrypt sensitive tenant settings in database
  SETTINGS_ENCRYPTION_KEY: "CHANGE_ME_generate_with_openssl_rand_base64_32"

  # gRPC API key for securing gRPC endpoints (generate with: openssl rand -base64 32)
  GRPC_API_KEYS: "CHANGE_ME_generate_with_openssl_rand_base64_32"
